<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE NgamsCfg SYSTEM "ngamsCfg.dtd">

<NgamsCfg Id="ngamsCfgALMA">

  <Header Context="NGAMS" 
          Name="ngamsServer.xml" 
          Release="1.0" 
          Revision="@(#) $Id: NgamsCfg.Demo.Oracle.xml,v 1.2 2008/03/06 11:48:43 jknudstr Exp $"
          Source="ngast@eso.org" 
          Type="NGAMS-DEMO-CONFIGURATION">
    <Description/>
  </Header>

  <Server ArchiveName="ALMA-ARCHIVE" 
          BlockSize="65536"
          MaxSimReqs="30" 
          RootDirectory="/tmp/NGAS" 
          PortNo="7777" 
          ProxyMode="1"
          Simulation="1"
          SwVersion=""/>

  <JanitorThread SuspensionTime="0T00:10:00" 
                 MinSpaceSysDirMb="200"/>

  <ArchiveHandling ArchiveUnits="" 
                   BackLogBufferDirectory="/tmp/NGAS/"
                   BackLogBuffering="0"
                   FreeSpaceDiskChangeMb="100"
                   MinFreeSpaceWarningMb="500"
                   PathPrefix="data"
                   Replication="1"/>

  <Db Interface="ngamsOracle" 
      Name="alma1" 
      Password="bmdhcyRkYmE=\n" 
      Server="archive1" 
      Snapshot="1" 
      User="ngastest1"/>

  <SystemPlugIns LabelPrinterPlugIn="-" 
                 LabelPrinterPlugInPars="-" 
                 OfflinePlugIn="ngamsLinuxOfflinePlugIn" 
                 OfflinePlugInPars="unmount=1" 
                 OnlinePlugIn="ngamsLinuxOnlinePlugIn" 
                 OnlinePlugInPars="uri=/usr/local/sbin/tw_cli,
                                   old_format=0,dev_start_idx=d"
                 DiskSyncPlugIn="ngamsDiskSyncPlugIn"
                 DiskSyncPlugInPars=""/>

  <Permissions AllowArchiveReq="1" 
               AllowProcessingReq="1" 
               AllowRemoveReq="1" 
               AllowRetrieveReq="1"/>

  <MimeTypes Id="MimeTypes-Std">
    <MimeTypeMap Extension="fits" MimeType="image/x-fits"/>
    <MimeTypeMap Extension="nglog" MimeType="ngas/nglog"/>
    <MimeTypeMap Extension="nglog.Z" MimeType="application/x-nglog"/>
    <MimeTypeMap Extension="log" MimeType="text/log-file"/>
    <MimeTypeMap Extension="log.Z" MimeType="application/x-clog"/>
    <MimeTypeMap Extension="paf" MimeType="ngas/paf"/>
    <MimeTypeMap Extension="fits.gz" MimeType="application/x-gfits"/>
    <MimeTypeMap Extension="fits.Z" MimeType="application/x-cfits"/>
    <MimeTypeMap Extension="hfits" MimeType="application/x-hfits"/>
    <MimeTypeMap Extension="hdr" MimeType="image/x-fitshdr"/>
    <MimeTypeMap Extension="tar" MimeType="application/x-tar"/>
    <MimeTypeMap Extension="msg" MimeType="multialma/related"/>
  </MimeTypes>

  <StorageSets>
    <StorageSet DiskLabel="BULK"
                MainDiskSlotId="1"
                RepDiskSlotId="2"
                Mutex="0"
                Synchronize="1" 
                StorageSetId="Volume1"/>
    <StorageSet DiskLabel="BULK" 
                MainDiskSlotId="3" 
                Mutex="0" 
                RepDiskSlotId="4" 
                StorageSetId="Volume2" 
                Synchronize="1"/>
    <StorageSet DiskLabel="BULK" 
                MainDiskSlotId="5" 
                Mutex="0" 
                RepDiskSlotId="6" 
                StorageSetId="Volume3" 
                Synchronize="1"/>
  </StorageSets>

  <Streams>
    <Stream MimeType="application/octet-stream"
            PlugIn="ngasGenDapi" 
            PlugInPars="">
      <StorageSetRef StorageSetId="Volume1"/>
      <StorageSetRef StorageSetId="Volume2"/>
      <StorageSetRef StorageSetId="Volume3"/>
    </Stream>
    <Stream MimeType="image/x-fits" 
            PlugIn="ngamsFitsPlugIn" 
            PlugInPars="compression=compress -f,
                        checksum_util=utilFitsChecksum,
                        checksum_result=0/0000000000000000,
                        frame_ingest_db_id=TEST_SRV">
      <StorageSetRef StorageSetId="Volume1"/>
      <StorageSetRef StorageSetId="Volume2"/>
      <StorageSetRef StorageSetId="Volume3"/>
    </Stream>
    <Stream MimeType="cal/x-fits" PlugIn="ngamsCalibDapi" PlugInPars="">
      <StorageSetRef StorageSetId="Volume1"/>
      <StorageSetRef StorageSetId="Volume2"/>
      <StorageSetRef StorageSetId="Volume3"/>
    </Stream>
    <Stream MimeType="cal/x-tfits" PlugIn="ngamsCalibDapi" PlugInPars="">
      <StorageSetRef StorageSetId="Volume1"/>
      <StorageSetRef StorageSetId="Volume2"/>
      <StorageSetRef StorageSetId="Volume3"/>
    </Stream>
    <Stream MimeType="non/existing" PlugIn="ngamsNonExisting" PlugInPars="">
      <StorageSetRef StorageSetId="Volume1"/>
      <StorageSetRef StorageSetId="Volume2"/>
      <StorageSetRef StorageSetId="Volume3"/>
    </Stream>
    <Stream MimeType="application/x-cfits"
            PlugIn="ngamsFitsPlugIn" 
            PlugInPars="compression=compress -f,
                        checksum_util=utilFitsChecksum,
                        checksum_result=0/0000000000000000">
      <StorageSetRef StorageSetId="Volume1"/>
      <StorageSetRef StorageSetId="Volume2"/>
      <StorageSetRef StorageSetId="Volume3"/>
    </Stream>
    <Stream MimeType="application/x-gfits" 
            PlugIn="ngamsFitsPlugIn" 
            PlugInPars="compression=compress -f,
                        checksum_util=utilFitsChecksum,
                        checksum_result=0/0000000000000000">
      <StorageSetRef StorageSetId="Volume1"/>
      <StorageSetRef StorageSetId="Volume2"/>
      <StorageSetRef StorageSetId="Volume3"/>
    </Stream>
    <Stream MimeType="ngas/nglog" 
            PlugIn="ngamsNgLogPlugIn"
            PlugInPars="">
      <StorageSetRef StorageSetId="Volume1"/>
      <StorageSetRef StorageSetId="Volume2"/>
      <StorageSetRef StorageSetId="Volume3"/>
    </Stream>
    <Stream MimeType="text/log-file"
            PlugIn="ngamsNgLogPlugIn"
            PlugInPars="">
      <StorageSetRef StorageSetId="Volume1"/>
      <StorageSetRef StorageSetId="Volume2"/>
      <StorageSetRef StorageSetId="Volume3"/>
    </Stream>
    <Stream MimeType="application/x-tar"
            PlugIn="ngasTarBallPlugIn"
            PlugInPars="">
      <StorageSetRef StorageSetId="Volume1"/>
      <StorageSetRef StorageSetId="Volume2"/>
      <StorageSetRef StorageSetId="Volume3"/>
    </Stream>
    <Stream MimeType="multialma/related"
            PlugIn="ngamsAlmaMultipart"
            PlugInPars="">
      <StorageSetRef StorageSetId="Volume1"/>
      <StorageSetRef StorageSetId="Volume2"/>
      <StorageSetRef StorageSetId="Volume3"/>
    </Stream>
  </Streams>

  <Processing ProcessingDirectory="/tmp/NGAS">
    <PlugIn Name="ngamsEsoArchDppi" 
            PlugInPars="">
      <MimeType Name="image/x-fits"/>
      <MimeType Name="application/x-gfits"/>
      <MimeType Name="application/x-cfits"/>
    </PlugIn>
    <PlugIn Name="ngamsExtractFitsHdrDppi" 
            PlugInPars="">
      <MimeType Name="image/x-fits"/>
      <MimeType Name="application/x-gfits"/>
      <MimeType Name="application/x-cfits"/>
    </PlugIn>
    <PlugIn Name="ngasWfiPreview" 
            PlugInPars="">
      <MimeType Name="image/x-fits"/>
      <MimeType Name="application/x-gfits"/>
      <MimeType Name="application/x-cfits"/>
    </PlugIn>
  </Processing>

  <Register>
    <PlugIn Name="ngamsFitsRegPlugIn" 
            PlugInPars="checksum_util=utilFitsChecksum,
                        checksum_result=0/0000000000000000">
      <MimeType Name="image/x-fits"/>
      <MimeType Name="application/x-gfits"/>
      <MimeType Name="application/x-cfits"/>
    </PlugIn>
  </Register>

  <DataCheckThread Active="1" 
                   ChecksumPlugIn="ngamsGenCrc32"  
                   ChecksumPlugInPars="" 
		   DiskSeq="SEQUENTIAL" 
                   FileSeq="SEQUENTIAL" 
                   ForceNotif="1" 
                   LogSummary="1" 
                   MaxProcs="4" 
                   MinCycle="01T00:00:00" 
                   Prio="0" 
                   Scan="0"/>

  <Log LocalLogFile="/tmp/NGAS/log/LogFile.nglog" 
       LocalLogLevel="3" 
       LogBufferSize="0"
       LogRotateCache="30" 
       LogRotateInt="01T00:00:00" 
       SysLog="0" 
       SysLogPrefix="DFSLog"/>

  <Notification Active="1" 
                MaxRetentionSize="1" 
                MaxRetentionTime="00T00:30:00" 
                Sender="ngast@hq.eso.org" 
                SmtpHost="smtphost.hq.eso.org">
    <AlertNotification>
      <EmailRecipient Address="DEFINE@eso.org"/>
    </AlertNotification>
    <ErrorNotification>
      <EmailRecipient Address="DEFINE@eso.org"/>
    </ErrorNotification>
    <DiskSpaceNotification>
      <EmailRecipient Address="DEFINE@eso.org"/>
    </DiskSpaceNotification>
    <DiskChangeNotification>
      <EmailRecipient Address="DEFINE@eso.org"/>
    </DiskChangeNotification>
    <NoDiskSpaceNotification>
      <EmailRecipient Address="DEFINE@eso.org"/>
    </NoDiskSpaceNotification>
    <DataCheckNotification>
      <EmailRecipient Address="DEFINE@eso.org"/>
    </DataCheckNotification>
  </Notification>

  <HostSuspension IdleSuspension="0" 
                  IdleSuspensionTime="60" 
                  SuspensionPlugIn="ngamsSuspensionPlugIn" 
                  SuspensionPlugInPars="--SuspensionPlugInPars--" 
                  WakeUpCallTimeOut="200" 
                  WakeUpPlugIn="ngamsWakeUpPlugIn" 
                  WakeUpPlugInPars="eth0,eth1" 
                  WakeUpServerHost="dmdarc1"/>

  <SubscriptionDef AutoUnsubscribe="1" 
                   BackLogExpTime="28T00:00:00" 
                   Enable="0" 
                   SuspensionTime="0T00:03:00">
    <Subscription  HostId="HostId1"
                   PortNo="1234"
                   Priority="1"
                   SubscriberUrl="http://test.url1"
                   FilterPlugIn="FilterPlugIn1"
                   FilterPlugInPars="1,2,3,4"/>
    <Subscription  HostId="HostId2"
                   PortNo="5678"
                   Priority="2"
                   SubscriberUrl="http://test.url2"
                   FilterPlugIn="FilterPlugIn2"
                   FilterPlugInPars="5,6,7,8"/>
  </SubscriptionDef>


  <Authorization Enable="0">
    <User Name="ngas" 
          Password="bmdhcw=="/>
    <User Name="ngasmgr" 
          Password="bmdhc21ncg=="/>
    <User Name="ngas-int"
          Password="bmdhcy1pbnQ="/>
  </Authorization>

</NgamsCfg>
